{"ast":null,"code":"var _jsxFileName = \"/home/uladzimir/All/Studies/microblog/microblog/frontend/src/pages/Post.js\";\nimport PropTypes from 'prop-types';\nimport { NavLink } from 'react-router-dom';\nimport ReactDOM from 'react-dom';\nimport React, { Component, Fragment } from 'react';\nimport axiosInstance from '../axios';\nimport Loader from '../Loader';\nimport CommentsList from '../components/CommentsList';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faComment as commentReg, faThumbsDown as dislikeReg, faThumbsUp as likeReg } from '@fortawesome/free-regular-svg-icons';\nimport { faReply, faComment as commentSol, faThumbsDown as dislikeSol, faThumbsUp as likeSol, faCross, faTimes } from '@fortawesome/free-solid-svg-icons';\nimport AddComment from '../components/AddComment';\nimport Modal from '../components/Modal';\nimport Recommend from '../components/Recommend';\n\nclass Post extends Component {\n  constructor(props) {\n    super(props);\n\n    this.btnClick = e => {\n      e.preventDefault();\n      let element = e.target.getAttribute('name');\n      console.log(element);\n\n      switch (element) {\n        case 'like':\n          axiosInstance.post(`http://localhost:8000/api/posts/like/${this.state.post.id}`, {\n            liked: this.state.liked\n          }).then(response => this.setState({\n            liked: !this.state.liked,\n            post: response.data,\n            disliked: false\n          }));\n          break;\n\n        case 'dislike':\n          axiosInstance.post(`http://localhost:8000/api/posts/dislike/${this.state.post.id}`, {\n            disliked: this.state.disliked\n          }).then(response => this.setState({\n            disliked: !this.state.disliked,\n            post: response.data,\n            liked: false\n          }));\n          break;\n      }\n    };\n\n    this.postClick = e => {\n      e.preventDefault();\n      this.getPost(this.state.post.repost.id);\n    };\n\n    this.state = {\n      post: '',\n      comments: '',\n      loading_post: true,\n      loading_comments: true,\n      commenting: false,\n      liked: '',\n      disliked: '',\n      modal: false\n    };\n    this.commentClick = this.commentClick.bind(this);\n    this.getComments = this.getComments.bind(this);\n    this.btnClick = this.btnClick.bind(this);\n    this.toggleModal = this.toggleModal.bind(this);\n    this.deletePost = this.deletePost.bind(this);\n  }\n\n  componentDidMount() {\n    const id = this.props.match.params.id;\n    this.getCurrentUser();\n    this.getPost(id);\n  }\n\n  getCurrentUser() {\n    axiosInstance.get('http://localhost:8000/api/current_user/').then(res => {\n      this.setState({\n        account: res.data\n      });\n    });\n  }\n\n  getPost(id) {\n    axiosInstance.get(`http://localhost:8000/api/posts/${id}`).then(res => {\n      this.setState({\n        post: res.data,\n        loading_post: false\n      });\n      this.getComments(id);\n      this.state.post.likes.forEach(like => {\n        if (like.id == this.state.account.user.id) {\n          this.setState({\n            liked: true\n          });\n          console.log('Current user liked this post');\n        }\n      });\n      this.state.post.dislikes.forEach(dislike => {\n        if (dislike.id == this.state.account.user.id) {\n          this.setState({\n            disliked: true\n          });\n          console.log('Current user disliked this post');\n        }\n      });\n    });\n  }\n\n  getComments(id) {\n    axiosInstance.get(`http://localhost:8000/api/posts/comments/${id}`).then(res => {\n      this.setState({\n        comments: res.data,\n        loading_comments: false,\n        commenting: false\n      });\n      const comment = this.props.match.params.comment;\n\n      if (comment) {\n        this.setState({\n          commenting: true\n        });\n      }\n    });\n  }\n\n  deletePost() {\n    axiosInstance.delete(`http://localhost:8000/api/posts/delete/${this.state.post.id}`).then(res => {\n      console.log(res);\n      this.props.history.push('/');\n    });\n  }\n\n  formatDate(str) {\n    let date = new Date(str);\n    return date.getHours() + ':' + (date.getMinutes().length > 1 ? '0' + date.getMinutes() : date.getMinutes()) + ' Â· ' + date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();\n  }\n\n  getRandomInt(max) {\n    return Math.floor(Math.random() * Math.floor(max));\n  }\n\n  commentClick() {\n    this.setState({\n      commenting: !this.state.commenting\n    });\n    console.log(this.state.commenting);\n  }\n\n  toggleModal() {\n    this.setState({\n      modal: !this.state.modal\n    });\n  }\n\n  render() {\n    let repost = '';\n\n    if (this.state.post.repost) {\n      repost = /*#__PURE__*/React.createElement(NavLink, {\n        onClick: this.postClick,\n        style: {\n          textDecoration: \"none\",\n          color: \"inherit\"\n        },\n        to: \"/post/\" + this.state.post.repost.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"repost pt-2 pb-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          fontSize: '14pt'\n        },\n        className: \"mb-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n        style: {\n          color: \"#5b7083\"\n        },\n        name: \"repost\",\n        icon: faReply,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }\n      }), \" Repost from\\xA0\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex mb-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"rounded-circle\",\n        src: this.state.post.repost.user.img,\n        height: \"50\",\n        width: \"50\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ml-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"m-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 48\n        }\n      }, this.state.post.repost.user.user.first_name, \" \", this.state.post.repost.user.user.last_name)), /*#__PURE__*/React.createElement(NavLink, {\n        style: {\n          color: '#5b7083'\n        },\n        to: \"/user/\" + this.state.post.repost.user.user.username,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"m-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 121\n        }\n      }, \"@\", this.state.post.repost.user.user.username)))), /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          fontSize: \"14pt\"\n        },\n        className: \"m-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }\n      }, this.state.post.repost.body)));\n    }\n\n    let post = this.state.loading_post ? /*#__PURE__*/React.createElement(Loader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 46\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"article\", {\n      className: \"home-container pt-3 pl-3 pr-3 pb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"rounded-circle\",\n      src: this.state.post.user.img,\n      height: \"50\",\n      width: \"50\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ml-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"m-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 44\n      }\n    }, this.state.post.user.user.first_name, \" \", this.state.post.user.user.last_name)), /*#__PURE__*/React.createElement(NavLink, {\n      style: {\n        color: '#5b7083'\n      },\n      to: \"/user/\" + this.state.post.user.user.username,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"m-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 110\n      }\n    }, \"@\", this.state.post.user.user.username))), this.state.post.user.user.id == this.state.account.user.id ? /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      onClick: this.toggleModal,\n      className: \"ml-auto awesome-cross\",\n      icon: faTimes,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 21\n      }\n    }) : ''), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        fontSize: \"18pt\"\n      },\n      className: \"mt-2 mb-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 21\n      }\n    }, this.state.post.body), repost, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-3\",\n      style: {\n        color: '#5b7083',\n        fontSize: \"12pt\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 21\n      }\n    }, \" \", this.formatDate(this.state.post.date)), /*#__PURE__*/React.createElement(\"hr\", {\n      className: \"mt-3 mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-3\",\n      style: {\n        color: \"#5b7083\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      style: {\n        color: \"#212529\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 31\n      }\n    }, this.state.post.likes.length), \" likes\"), \"\\xA0|\\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      style: {\n        color: \"#212529\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 31\n      }\n    }, this.state.post.dislikes.length), \" dislikes\"), \"\\xA0|\\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      style: {\n        color: \"#212529\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 31\n      }\n    }, this.state.comments.length), \" comments\"), \"\\xA0|\\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      style: {\n        color: \"#212529\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 31\n      }\n    }, this.state.post.reposts_count), \" reposts\")), /*#__PURE__*/React.createElement(\"hr\", {\n      className: \"mt-3 mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-around\",\n      style: {\n        color: \"#5b7083\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      name: \"like\",\n      onClick: this.btnClick,\n      className: \"post-icon like-post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 29\n      }\n    }, this.state.liked ? /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      style: {\n        color: \"#17bf63\"\n      },\n      icon: likeSol,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 53\n      }\n    }) : /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: likeReg,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 126\n      }\n    }))), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      name: \"dislike\",\n      onClick: this.btnClick,\n      className: \"post-icon dislike-post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 29\n      }\n    }, this.state.disliked ? /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      style: {\n        color: \"#e0245e\"\n      },\n      icon: dislikeSol,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 56\n      }\n    }) : /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: dislikeReg,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 132\n      }\n    }))), /*#__PURE__*/React.createElement(\"p\", {\n      onClick: this.commentClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"post-icon repost-post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 56\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: this.state.commenting ? commentSol : commentReg,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 96\n      }\n    }))), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 25\n      }\n    }, \" \", /*#__PURE__*/React.createElement(NavLink, {\n      style: {\n        textDecoration: \"none\",\n        color: \"inherit\"\n      },\n      to: \"/repost/\" + this.state.post.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 29\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"span\", {\n      className: \"post-icon repost-post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 125\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: faReply,\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 165\n      }\n    }))))))), this.state.commenting && /*#__PURE__*/React.createElement(AddComment, {\n      focus: this.state.commenting,\n      post: this.state.post,\n      getComments: this.getComments,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 39\n      }\n    }));\n    let comments = this.state.loading_comments ? /*#__PURE__*/React.createElement(Loader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 54\n      }\n    }) : /*#__PURE__*/React.createElement(CommentsList, {\n      comments: this.state.comments,\n      post: this.state.post,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 67\n      }\n    });\n    return /*#__PURE__*/React.createElement(Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 13\n      }\n    }, this.state.modal && /*#__PURE__*/React.createElement(Modal, {\n      delete: this.deletePost,\n      toggle: this.toggleModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 38\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-10 col-lg-7\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 25\n      }\n    }, \"Post\"), post, comments), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ml-0 mb-4 d-none d-xl-block d-lg-block d-md-none col-lg-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \" side-container sticky-top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Recommend, {\n      content: 'posts',\n      user: this.state.post.user.user.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 29\n      }\n    }))))));\n  }\n\n}\n\nexport default Post;","map":{"version":3,"sources":["/home/uladzimir/All/Studies/microblog/microblog/frontend/src/pages/Post.js"],"names":["PropTypes","NavLink","ReactDOM","React","Component","Fragment","axiosInstance","Loader","CommentsList","FontAwesomeIcon","faComment","commentReg","faThumbsDown","dislikeReg","faThumbsUp","likeReg","faReply","commentSol","dislikeSol","likeSol","faCross","faTimes","AddComment","Modal","Recommend","Post","constructor","props","btnClick","e","preventDefault","element","target","getAttribute","console","log","post","state","id","liked","then","response","setState","data","disliked","postClick","getPost","repost","comments","loading_post","loading_comments","commenting","modal","commentClick","bind","getComments","toggleModal","deletePost","componentDidMount","match","params","getCurrentUser","get","res","account","likes","forEach","like","user","dislikes","dislike","comment","delete","history","push","formatDate","str","date","Date","getHours","getMinutes","length","getFullYear","getMonth","getDate","getRandomInt","max","Math","floor","random","render","textDecoration","color","fontSize","img","first_name","last_name","username","body","reposts_count"],"mappings":";AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,OAAT,QAAwB,kBAAxB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,aAAP,MAA0B,UAA1B;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,SAASC,eAAT,QAAgC,gCAAhC;AACA,SAASC,SAAS,IAAIC,UAAtB,EAAkCC,YAAY,IAAIC,UAAlD,EAA8DC,UAAU,IAAIC,OAA5E,QAA0F,qCAA1F;AACA,SAASC,OAAT,EAAkBN,SAAS,IAAIO,UAA/B,EAA2CL,YAAY,IAAIM,UAA3D,EAAuEJ,UAAU,IAAIK,OAArF,EAA8FC,OAA9F,EAAuGC,OAAvG,QAAqH,mCAArH;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;;AAEA,MAAMC,IAAN,SAAmBrB,SAAnB,CAA6B;AACzBsB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA4EnBC,QA5EmB,GA4ERC,CAAC,IAAI;AACZA,MAAAA,CAAC,CAACC,cAAF;AACA,UAAIC,OAAO,GAAGF,CAAC,CAACG,MAAF,CAASC,YAAT,CAAsB,MAAtB,CAAd;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;;AACA,cAAOA,OAAP;AACI,aAAK,MAAL;AACIzB,UAAAA,aAAa,CAAC8B,IAAd,CAAoB,wCAAuC,KAAKC,KAAL,CAAWD,IAAX,CAAgBE,EAAG,EAA9E,EAAiF;AAC7EC,YAAAA,KAAK,EAAE,KAAKF,KAAL,CAAWE;AAD2D,WAAjF,EAGCC,IAHD,CAGMC,QAAQ,IAAI,KAAKC,QAAL,CAAc;AAC5BH,YAAAA,KAAK,EAAE,CAAC,KAAKF,KAAL,CAAWE,KADS;AAE5BH,YAAAA,IAAI,EAAEK,QAAQ,CAACE,IAFa;AAG5BC,YAAAA,QAAQ,EAAE;AAHkB,WAAd,CAHlB;AAQA;;AACJ,aAAK,SAAL;AACItC,UAAAA,aAAa,CAAC8B,IAAd,CAAoB,2CAA0C,KAAKC,KAAL,CAAWD,IAAX,CAAgBE,EAAG,EAAjF,EAAoF;AAChFM,YAAAA,QAAQ,EAAE,KAAKP,KAAL,CAAWO;AAD2D,WAApF,EAGCJ,IAHD,CAGMC,QAAQ,IAAI,KAAKC,QAAL,CAAc;AAC5BE,YAAAA,QAAQ,EAAE,CAAC,KAAKP,KAAL,CAAWO,QADM;AAE5BR,YAAAA,IAAI,EAAEK,QAAQ,CAACE,IAFa;AAG5BJ,YAAAA,KAAK,EAAE;AAHqB,WAAd,CAHlB;AAQA;AApBR;AAsBH,KAtGkB;;AAAA,SA+HnBM,SA/HmB,GA+HPhB,CAAC,IAAG;AACZA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKgB,OAAL,CAAa,KAAKT,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBT,EAApC;AACH,KAlIkB;;AAEf,SAAKD,KAAL,GAAa;AACTD,MAAAA,IAAI,EAAE,EADG;AAETY,MAAAA,QAAQ,EAAE,EAFD;AAGTC,MAAAA,YAAY,EAAE,IAHL;AAITC,MAAAA,gBAAgB,EAAE,IAJT;AAKTC,MAAAA,UAAU,EAAE,KALH;AAMTZ,MAAAA,KAAK,EAAE,EANE;AAOTK,MAAAA,QAAQ,EAAE,EAPD;AAQTQ,MAAAA,KAAK,EAAE;AARE,KAAb;AAUA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,WAAL,GAAmB,KAAKA,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAK1B,QAAL,GAAgB,KAAKA,QAAL,CAAc0B,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKE,WAAL,GAAmB,KAAKA,WAAL,CAAiBF,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKG,UAAL,GAAkB,KAAKA,UAAL,CAAgBH,IAAhB,CAAqB,IAArB,CAAlB;AACH;;AAEDI,EAAAA,iBAAiB,GAAE;AACf,UAAMpB,EAAE,GAAG,KAAKX,KAAL,CAAWgC,KAAX,CAAiBC,MAAjB,CAAwBtB,EAAnC;AACA,SAAKuB,cAAL;AACA,SAAKf,OAAL,CAAaR,EAAb;AACH;;AAEDuB,EAAAA,cAAc,GAAE;AACZvD,IAAAA,aAAa,CACRwD,GADL,CACS,yCADT,EAEKtB,IAFL,CAEUuB,GAAG,IAAI;AACT,WAAKrB,QAAL,CAAc;AACdsB,QAAAA,OAAO,EAAED,GAAG,CAACpB;AADC,OAAd;AAGH,KANL;AAOC;;AAELG,EAAAA,OAAO,CAACR,EAAD,EAAI;AACPhC,IAAAA,aAAa,CAACwD,GAAd,CAAmB,mCAAkCxB,EAAG,EAAxD,EACCE,IADD,CACMuB,GAAG,IAAI;AACT,WAAKrB,QAAL,CAAc;AACVN,QAAAA,IAAI,EAAE2B,GAAG,CAACpB,IADA;AAEVM,QAAAA,YAAY,EAAE;AAFJ,OAAd;AAIA,WAAKM,WAAL,CAAiBjB,EAAjB;AACA,WAAKD,KAAL,CAAWD,IAAX,CAAgB6B,KAAhB,CAAsBC,OAAtB,CAA8BC,IAAI,IAAI;AAClC,YAAIA,IAAI,CAAC7B,EAAL,IAAW,KAAKD,KAAL,CAAW2B,OAAX,CAAmBI,IAAnB,CAAwB9B,EAAvC,EAA0C;AACtC,eAAKI,QAAL,CAAc;AAACH,YAAAA,KAAK,EAAE;AAAR,WAAd;AACAL,UAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AACH;AACJ,OALD;AAMA,WAAKE,KAAL,CAAWD,IAAX,CAAgBiC,QAAhB,CAAyBH,OAAzB,CAAiCI,OAAO,IAAI;AACxC,YAAIA,OAAO,CAAChC,EAAR,IAAc,KAAKD,KAAL,CAAW2B,OAAX,CAAmBI,IAAnB,CAAwB9B,EAA1C,EAA6C;AACzC,eAAKI,QAAL,CAAc;AAACE,YAAAA,QAAQ,EAAE;AAAX,WAAd;AACAV,UAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AACH;AACJ,OALD;AAMH,KAnBD;AAoBH;;AAEDoB,EAAAA,WAAW,CAACjB,EAAD,EAAI;AACXhC,IAAAA,aAAa,CAACwD,GAAd,CAAmB,4CAA2CxB,EAAG,EAAjE,EACCE,IADD,CACMuB,GAAG,IAAI;AACT,WAAKrB,QAAL,CAAc;AACVM,QAAAA,QAAQ,EAAEe,GAAG,CAACpB,IADJ;AAEVO,QAAAA,gBAAgB,EAAE,KAFR;AAGVC,QAAAA,UAAU,EAAE;AAHF,OAAd;AAKA,YAAMoB,OAAO,GAAG,KAAK5C,KAAL,CAAWgC,KAAX,CAAiBC,MAAjB,CAAwBW,OAAxC;;AACA,UAAIA,OAAJ,EAAY;AACR,aAAK7B,QAAL,CAAc;AACVS,UAAAA,UAAU,EAAE;AADF,SAAd;AAGH;AAEJ,KAdD;AAeH;;AA8BDM,EAAAA,UAAU,GAAE;AACRnD,IAAAA,aAAa,CAACkE,MAAd,CAAsB,0CAAyC,KAAKnC,KAAL,CAAWD,IAAX,CAAgBE,EAAG,EAAlF,EACCE,IADD,CACMuB,GAAG,IAAI;AACT7B,MAAAA,OAAO,CAACC,GAAR,CAAY4B,GAAZ;AACA,WAAKpC,KAAL,CAAW8C,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB;AACH,KAJD;AAKH;;AAEDC,EAAAA,UAAU,CAACC,GAAD,EAAK;AACX,QAAIC,IAAI,GAAG,IAAIC,IAAJ,CAASF,GAAT,CAAX;AACA,WAAOC,IAAI,CAACE,QAAL,KAAkB,GAAlB,IAAyBF,IAAI,CAACG,UAAL,GAAkBC,MAAlB,GAA2B,CAA3B,GAA+B,MAAMJ,IAAI,CAACG,UAAL,EAArC,GAAyDH,IAAI,CAACG,UAAL,EAAlF,IAAuG,KAAvG,GACAH,IAAI,CAACK,WAAL,EADA,GACoB,GADpB,IAC2BL,IAAI,CAACM,QAAL,KAAgB,CAD3C,IACgD,GADhD,GACsDN,IAAI,CAACO,OAAL,EAD7D;AAEH;;AAEDC,EAAAA,YAAY,CAACC,GAAD,EAAM;AACd,WAAOC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACC,KAAL,CAAWF,GAAX,CAA3B,CAAP;AACH;;AAEDjC,EAAAA,YAAY,GAAE;AACV,SAAKX,QAAL,CAAc;AAACS,MAAAA,UAAU,EAAE,CAAC,KAAKd,KAAL,CAAWc;AAAzB,KAAd;AACAjB,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKE,KAAL,CAAWc,UAAvB;AACH;;AAODK,EAAAA,WAAW,GAAE;AACT,SAAKd,QAAL,CAAc;AACVU,MAAAA,KAAK,EAAE,CAAC,KAAKf,KAAL,CAAWe;AADT,KAAd;AAGH;;AAEDsC,EAAAA,MAAM,GAAE;AACJ,QAAI3C,MAAM,GAAG,EAAb;;AACA,QAAI,KAAKV,KAAL,CAAWD,IAAX,CAAgBW,MAApB,EAA2B;AACvBA,MAAAA,MAAM,gBACN,oBAAC,OAAD;AAAS,QAAA,OAAO,EAAE,KAAKF,SAAvB;AAAkC,QAAA,KAAK,EAAE;AAAC8C,UAAAA,cAAc,EAAE,MAAjB;AAAyBC,UAAAA,KAAK,EAAE;AAAhC,SAAzC;AAAqF,QAAA,EAAE,EAAE,WAAW,KAAKvD,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBT,EAA3H;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACA;AAAG,QAAA,KAAK,EAAE;AAACuD,UAAAA,QAAQ,EAAE;AAAX,SAAV;AAA8B,QAAA,SAAS,EAAC,MAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,eAAD;AAAiB,QAAA,KAAK,EAAE;AAAED,UAAAA,KAAK,EAAC;AAAR,SAAxB;AAA4C,QAAA,IAAI,EAAC,QAAjD;AAA0D,QAAA,IAAI,EAAE5E,OAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,qBADA,eAII;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAgC,QAAA,GAAG,EAAE,KAAKqB,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBqB,IAAvB,CAA4B0B,GAAjE;AAAsE,QAAA,MAAM,EAAC,IAA7E;AAAkF,QAAA,KAAK,EAAC,IAAxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,eAEI;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAG,QAAA,SAAS,EAAC,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAI,KAAKzD,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBqB,IAAvB,CAA4BA,IAA5B,CAAiC2B,UAArC,OAAkD,KAAK1D,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBqB,IAAvB,CAA4BA,IAA5B,CAAiC4B,SAAnF,CAAnB,CADJ,eAEI,oBAAC,OAAD;AAAS,QAAA,KAAK,EAAE;AAACJ,UAAAA,KAAK,EAAC;AAAP,SAAhB;AAAoC,QAAA,EAAE,EAAE,WAAS,KAAKvD,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBqB,IAAvB,CAA4BA,IAA5B,CAAiC6B,QAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAA4F;AAAG,QAAA,SAAS,EAAC,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqB,KAAK5D,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBqB,IAAvB,CAA4BA,IAA5B,CAAiC6B,QAAtD,CAA5F,CAFJ,CAFJ,CAJJ,eAWI;AAAG,QAAA,KAAK,EAAE;AAACJ,UAAAA,QAAQ,EAAE;AAAX,SAAV;AAA8B,QAAA,SAAS,EAAC,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA+C,KAAKxD,KAAL,CAAWD,IAAX,CAAgBW,MAAhB,CAAuBmD,IAAtE,CAXJ,CADJ,CADA;AAgBH;;AACD,QAAI9D,IAAI,GAAG,KAAKC,KAAL,CAAWY,YAAX,gBAA0B,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA1B,gBACP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAS,MAAA,SAAS,EAAC,oCAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAgC,MAAA,GAAG,EAAE,KAAKZ,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqB0B,GAA1D;AAA+D,MAAA,MAAM,EAAC,IAAtE;AAA2E,MAAA,KAAK,EAAC,IAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAEI;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAG,MAAA,SAAS,EAAC,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAI,KAAKzD,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B2B,UAA9B,OAA2C,KAAK1D,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B4B,SAArE,CAAnB,CADJ,eAEI,oBAAC,OAAD;AAAS,MAAA,KAAK,EAAE;AAACJ,QAAAA,KAAK,EAAC;AAAP,OAAhB;AAAoC,MAAA,EAAE,EAAE,WAAS,KAAKvD,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B6B,QAA3E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAqF;AAAG,MAAA,SAAS,EAAC,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAqB,KAAK5D,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B6B,QAA/C,CAArF,CAFJ,CAFJ,EAMK,KAAK5D,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B9B,EAA1B,IAAgC,KAAKD,KAAL,CAAW2B,OAAX,CAAmBI,IAAnB,CAAwB9B,EAAxD,gBACD,oBAAC,eAAD;AAAiB,MAAA,OAAO,EAAE,KAAKkB,WAA/B;AAA4C,MAAA,SAAS,EAAC,uBAAtD;AAA8E,MAAA,IAAI,EAAEnC,OAApF;AAA6F,MAAA,IAAI,EAAC,IAAlG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADC,GAC0G,EAP/G,CADJ,eAUI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAG,MAAA,KAAK,EAAE;AAACwE,QAAAA,QAAQ,EAAE;AAAX,OAAV;AAA8B,MAAA,SAAS,EAAC,WAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAsD,KAAKxD,KAAL,CAAWD,IAAX,CAAgB8D,IAAtE,CADJ,EAEKnD,MAFL,eAGI;AAAG,MAAA,SAAS,EAAC,MAAb;AAAoB,MAAA,KAAK,EAAE;AAAC6C,QAAAA,KAAK,EAAC,SAAP;AAAkBC,QAAAA,QAAQ,EAAE;AAA5B,OAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAkE,KAAKlB,UAAL,CAAgB,KAAKtC,KAAL,CAAWD,IAAX,CAAgByC,IAAhC,CAAlE,CAHJ,eAII;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJJ,eAKI;AAAG,MAAA,SAAS,EAAC,MAAb;AAAoB,MAAA,KAAK,EAAE;AAACe,QAAAA,KAAK,EAAE;AAAR,OAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAM;AAAG,MAAA,KAAK,EAAE;AAACA,QAAAA,KAAK,EAAE;AAAR,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+B,KAAKvD,KAAL,CAAWD,IAAX,CAAgB6B,KAAhB,CAAsBgB,MAArD,CAAN,WADJ,4BAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAM;AAAG,MAAA,KAAK,EAAE;AAACW,QAAAA,KAAK,EAAE;AAAR,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+B,KAAKvD,KAAL,CAAWD,IAAX,CAAgBiC,QAAhB,CAAyBY,MAAxD,CAAN,cAHJ,4BAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAM;AAAG,MAAA,KAAK,EAAE;AAACW,QAAAA,KAAK,EAAE;AAAR,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+B,KAAKvD,KAAL,CAAWW,QAAX,CAAoBiC,MAAnD,CAAN,cALJ,4BAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAM;AAAG,MAAA,KAAK,EAAE;AAACW,QAAAA,KAAK,EAAE;AAAR,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+B,KAAKvD,KAAL,CAAWD,IAAX,CAAgB+D,aAA/C,CAAN,aAPJ,CALJ,eAcI;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAdJ,eAeI;AAAK,MAAA,SAAS,EAAC,+BAAf;AAA+C,MAAA,KAAK,EAAE;AAACP,QAAAA,KAAK,EAAE;AAAR,OAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAM,MAAA,IAAI,EAAC,MAAX;AAAkB,MAAA,OAAO,EAAE,KAAKhE,QAAhC;AAA0C,MAAA,SAAS,EAAC,qBAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKS,KAAL,CAAWE,KAAX,gBAAmB,oBAAC,eAAD;AAAiB,MAAA,KAAK,EAAE;AAACqD,QAAAA,KAAK,EAAC;AAAP,OAAxB;AAA0C,MAAA,IAAI,EAAGzE,OAAjD;AAA2D,MAAA,IAAI,EAAC,IAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAnB,gBAA4F,oBAAC,eAAD;AAAiB,MAAA,IAAI,EAAGJ,OAAxB;AAAkC,MAAA,IAAI,EAAC,IAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADjG,CADJ,CADJ,eAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAM,MAAA,IAAI,EAAC,SAAX;AAAqB,MAAA,OAAO,EAAE,KAAKa,QAAnC;AAA6C,MAAA,SAAS,EAAC,wBAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKS,KAAL,CAAWO,QAAX,gBAAsB,oBAAC,eAAD;AAAiB,MAAA,KAAK,EAAE;AAACgD,QAAAA,KAAK,EAAC;AAAP,OAAxB;AAA2C,MAAA,IAAI,EAAG1E,UAAlD;AAA8D,MAAA,IAAI,EAAC,IAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAtB,gBAAkG,oBAAC,eAAD;AAAiB,MAAA,IAAI,EAAGL,UAAxB;AAAoC,MAAA,IAAI,EAAC,IAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADvG,CADJ,CANJ,eAYI;AAAG,MAAA,OAAO,EAAE,KAAKwC,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA+B;AAAM,MAAA,SAAS,EAAC,uBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAwC,oBAAC,eAAD;AAAiB,MAAA,IAAI,EAAE,KAAKhB,KAAL,CAAWc,UAAX,GAAwBlC,UAAxB,GAAqCN,UAA5D;AAAwE,MAAA,IAAI,EAAC,IAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAxC,CAA/B,CAZJ,eAaI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAI,oBAAC,OAAD;AAAS,MAAA,KAAK,EAAE;AAACgF,QAAAA,cAAc,EAAE,MAAjB;AAAyBC,QAAAA,KAAK,EAAE;AAAhC,OAAhB;AAA4D,MAAA,EAAE,EAAE,aAAW,KAAKvD,KAAL,CAAWD,IAAX,CAAgBE,EAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAgG;AAAM,MAAA,SAAS,EAAC,uBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAwC,oBAAC,eAAD;AAAiB,MAAA,IAAI,EAAEtB,OAAvB;AAAgC,MAAA,IAAI,EAAC,IAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAxC,CAAhG,CAAJ,CAbJ,CAfJ,CAVJ,CADA,EA2CC,KAAKqB,KAAL,CAAWc,UAAX,iBAAyB,oBAAC,UAAD;AAAY,MAAA,KAAK,EAAE,KAAKd,KAAL,CAAWc,UAA9B;AAA0C,MAAA,IAAI,EAAE,KAAKd,KAAL,CAAWD,IAA3D;AAAiE,MAAA,WAAW,EAAE,KAAKmB,WAAnF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA3C1B,CADJ;AA8CA,QAAIP,QAAQ,GAAG,KAAKX,KAAL,CAAWa,gBAAX,gBAA8B,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA9B,gBAA2C,oBAAC,YAAD;AAAc,MAAA,QAAQ,EAAE,KAAKb,KAAL,CAAWW,QAAnC;AAA6C,MAAA,IAAI,EAAE,KAAKX,KAAL,CAAWD,IAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA1D;AACA,wBACA,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKC,KAAL,CAAWe,KAAX,iBAAoB,oBAAC,KAAD;AAAO,MAAA,MAAM,EAAE,KAAKK,UAApB;AAAgC,MAAA,MAAM,EAAE,KAAKD,WAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADzB,eAEI;AAAK,MAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,QAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,EAEKpB,IAFL,EAGKY,QAHL,CADJ,eAMI;AAAK,MAAA,SAAS,EAAC,2DAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,SAAD;AAAW,MAAA,OAAO,EAAE,OAApB;AAA6B,MAAA,IAAI,EAAE,KAAKX,KAAL,CAAWD,IAAX,CAAgBgC,IAAhB,CAAqBA,IAArB,CAA0B9B,EAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,CANJ,CAFJ,CADJ,CADA;AAmBL;;AAjO0B;;AAoO7B,eAAeb,IAAf","sourcesContent":["import PropTypes from 'prop-types';\nimport { NavLink } from 'react-router-dom';\nimport ReactDOM from 'react-dom'\nimport React, { Component, Fragment } from 'react';\nimport axiosInstance from '../axios';\nimport Loader from '../Loader'\nimport CommentsList from '../components/CommentsList'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faComment as commentReg, faThumbsDown as dislikeReg, faThumbsUp as likeReg} from '@fortawesome/free-regular-svg-icons'\nimport { faReply, faComment as commentSol, faThumbsDown as dislikeSol, faThumbsUp as likeSol, faCross, faTimes} from '@fortawesome/free-solid-svg-icons';\nimport AddComment from '../components/AddComment'\nimport Modal from '../components/Modal';\nimport Recommend from '../components/Recommend';\n\nclass Post extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            post: '',\n            comments: '',\n            loading_post: true,\n            loading_comments: true,\n            commenting: false,\n            liked: '',\n            disliked: '',\n            modal: false\n        };\n        this.commentClick = this.commentClick.bind(this)\n        this.getComments = this.getComments.bind(this)\n        this.btnClick = this.btnClick.bind(this)\n        this.toggleModal = this.toggleModal.bind(this)\n        this.deletePost = this.deletePost.bind(this)\n    }\n\n    componentDidMount(){        \n        const id = this.props.match.params.id;\n        this.getCurrentUser();\n        this.getPost(id);\n    }\n\n    getCurrentUser(){\n        axiosInstance\n            .get('http://localhost:8000/api/current_user/')\n            .then(res => {\n                this.setState({\n                account: res.data\n                });\n            });\n        }\n\n    getPost(id){\n        axiosInstance.get(`http://localhost:8000/api/posts/${id}`)\n        .then(res => {\n            this.setState({\n                post: res.data,\n                loading_post: false,\n            });\n            this.getComments(id);\n            this.state.post.likes.forEach(like => {\n                if (like.id == this.state.account.user.id){\n                    this.setState({liked: true})\n                    console.log('Current user liked this post')\n                }\n            })\n            this.state.post.dislikes.forEach(dislike => {\n                if (dislike.id == this.state.account.user.id){\n                    this.setState({disliked: true})\n                    console.log('Current user disliked this post')\n                }\n            })\n        })\n    }\n\n    getComments(id){\n        axiosInstance.get(`http://localhost:8000/api/posts/comments/${id}`)\n        .then(res => {\n            this.setState({\n                comments: res.data,\n                loading_comments: false,\n                commenting: false\n            });\n            const comment = this.props.match.params.comment;\n            if (comment){\n                this.setState({\n                    commenting: true,\n                })\n            }\n                \n        })\n    }\n\n    btnClick = e => {\n        e.preventDefault();\n        let element = e.target.getAttribute('name');\n        console.log(element)\n        switch(element){\n            case 'like':\n                axiosInstance.post(`http://localhost:8000/api/posts/like/${this.state.post.id}`, {\n                    liked: this.state.liked\n                })\n                .then(response => this.setState({\n                    liked: !this.state.liked,\n                    post: response.data,\n                    disliked: false\n                }))  \n                break;\n            case 'dislike':\n                axiosInstance.post(`http://localhost:8000/api/posts/dislike/${this.state.post.id}`, {\n                    disliked: this.state.disliked\n                })\n                .then(response => this.setState({\n                    disliked: !this.state.disliked,\n                    post: response.data,\n                    liked: false\n                }))\n                break;\n        }\n    }\n\n    deletePost(){\n        axiosInstance.delete(`http://localhost:8000/api/posts/delete/${this.state.post.id}`)\n        .then(res => {\n            console.log(res);\n            this.props.history.push('/');\n        })\n    }\n\n    formatDate(str){\n        let date = new Date(str);\n        return date.getHours() + ':' + (date.getMinutes().length > 1 ? '0' + date.getMinutes() : date.getMinutes()) + ' Â· ' + \n               date.getFullYear()+ '-' + (date.getMonth()+1) + '-' + date.getDate();   \n    }\n\n    getRandomInt(max) {\n        return Math.floor(Math.random() * Math.floor(max));\n    }\n    \n    commentClick(){\n        this.setState({commenting: !this.state.commenting});\n        console.log(this.state.commenting)\n    }\n\n    postClick = e =>{\n        e.preventDefault();\n        this.getPost(this.state.post.repost.id);\n    }\n\n    toggleModal(){\n        this.setState({\n            modal: !this.state.modal\n        })\n    }\n\n    render(){\n        let repost = ''\n        if (this.state.post.repost){\n            repost = \n            <NavLink onClick={this.postClick} style={{textDecoration: \"none\", color: \"inherit\"}} to={\"/post/\" + this.state.post.repost.id}> \n                <div className=\"repost pt-2 pb-2\">\n                <p style={{fontSize: '14pt'}} className=\"mb-1\"> \n                    <FontAwesomeIcon style={{ color:\"#5b7083\"}} name=\"repost\" icon={faReply}/> Repost from&nbsp;\n                </p>\n                    <div className=\"d-flex mb-1\">\n                        <img className=\"rounded-circle\" src={this.state.post.repost.user.img} height=\"50\" width=\"50\"></img>\n                        <div className=\"ml-2\">\n                            <p className=\"m-0\"><b>{this.state.post.repost.user.user.first_name} {this.state.post.repost.user.user.last_name}</b></p>\n                            <NavLink style={{color:'#5b7083'}}  to={\"/user/\"+this.state.post.repost.user.user.username}><p className=\"m-0\">@{this.state.post.repost.user.user.username}</p></NavLink>\n                        </div>\n                    </div>\n                    <p style={{fontSize: \"14pt\"}} className=\"m-0\">{this.state.post.repost.body}</p>\n                </div>\n            </NavLink>\n        }\n        let post = this.state.loading_post ? <Loader /> : \n            <div>\n            <article className=\"home-container pt-3 pl-3 pr-3 pb-0\">\n                <div className=\"d-flex\">\n                    <img className=\"rounded-circle\" src={this.state.post.user.img} height=\"50\" width=\"50\"></img>\n                    <div className=\"ml-2\">\n                        <p className=\"m-0\"><b>{this.state.post.user.user.first_name} {this.state.post.user.user.last_name}</b></p>\n                        <NavLink style={{color:'#5b7083'}}  to={\"/user/\"+this.state.post.user.user.username}><p className=\"m-0\">@{this.state.post.user.user.username}</p></NavLink>\n                    </div>\n                    {this.state.post.user.user.id == this.state.account.user.id ? \n                    <FontAwesomeIcon onClick={this.toggleModal} className=\"ml-auto awesome-cross\" icon={faTimes} size=\"lg\"/> : ''}\n                </div>\n                <div>\n                    <p style={{fontSize: \"18pt\"}} className=\"mt-2 mb-1\" >{this.state.post.body}</p>\n                    {repost}\n                    <p className=\"mb-3\" style={{color:'#5b7083', fontSize: \"12pt\"}}> {this.formatDate(this.state.post.date)}</p>\n                    <hr className=\"mt-3 mb-3\"/>\n                    <p className=\"mb-3\" style={{color: \"#5b7083\"}}> \n                        <span><b style={{color: \"#212529\"}}>{this.state.post.likes.length}</b> likes</span> \n                        &nbsp;|&nbsp;\n                        <span><b style={{color: \"#212529\"}}>{this.state.post.dislikes.length}</b> dislikes</span>\n                        &nbsp;|&nbsp;\n                        <span><b style={{color: \"#212529\"}}>{this.state.comments.length}</b> comments</span>\n                        &nbsp;|&nbsp;\n                        <span><b style={{color: \"#212529\"}}>{this.state.post.reposts_count}</b> reposts</span>\n                    </p>\n                    <hr className=\"mt-3 mb-3\"/>\n                    <div className='d-flex justify-content-around' style={{color: \"#5b7083\"}}>\n                        <p>\n                            <span name=\"like\" onClick={this.btnClick} className=\"post-icon like-post\">\n                                {this.state.liked ? <FontAwesomeIcon style={{color:\"#17bf63\"}}icon={ likeSol } size=\"lg\"/> : <FontAwesomeIcon icon={ likeReg } size=\"lg\"/>}\n                            </span>\n                        </p>\n                        <p>\n                            <span name=\"dislike\" onClick={this.btnClick} className=\"post-icon dislike-post\">\n                                {this.state.disliked ? <FontAwesomeIcon style={{color:\"#e0245e\"}} icon={ dislikeSol} size=\"lg\"/> : <FontAwesomeIcon icon={ dislikeReg} size=\"lg\"/>}\n                                \n                            </span>\n                        </p>\n                        <p onClick={this.commentClick}><span className=\"post-icon repost-post\"><FontAwesomeIcon icon={this.state.commenting ? commentSol : commentReg} size=\"lg\"/></span></p>\n                        <p> <NavLink style={{textDecoration: \"none\", color: \"inherit\"}} to={\"/repost/\"+this.state.post.id}> <span className=\"post-icon repost-post\"><FontAwesomeIcon icon={faReply} size=\"lg\"/></span></NavLink></p>\n                    </div>\n                </div>\n            </article>\n            {this.state.commenting && <AddComment focus={this.state.commenting} post={this.state.post} getComments={this.getComments}/>}\n            </div>\n        let comments = this.state.loading_comments ? <Loader /> : <CommentsList comments={this.state.comments} post={this.state.post} ></CommentsList>\n        return(\n        <Fragment>\n            <div className=\"container\">\n                {this.state.modal && <Modal delete={this.deletePost} toggle={this.toggleModal}/>}\n                <div className=\"row justify-content-center\">\n                    <div className=\"col-md-10 col-lg-7\">\n                        <h5 className=\"header\">Post</h5>\n                        {post}\n                        {comments}\n                    </div>\n                    <div className=\"ml-0 mb-4 d-none d-xl-block d-lg-block d-md-none col-lg-4\">\n                        <div className=\" side-container sticky-top\">\n                            <Recommend content={'posts'} user={this.state.post.user.user.id}/>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </Fragment>\n    )\n  }\n}\n\nexport default Post"]},"metadata":{},"sourceType":"module"}