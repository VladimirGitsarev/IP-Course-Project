{"ast":null,"code":"var _jsxFileName = \"/home/uladzimir/All/Studies/microblog/microblog/frontend/src/App.js\";\nimport React, { Component, useState } from 'react';\nimport { BrowserRouter, Redirect, Router, Route, Switch } from 'react-router-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport Popper from 'popper.js';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport axiosInstance from 'axios';\nimport { createBrowserHistory } from 'history';\nimport { Home } from './pages/Home';\nimport { About } from './pages/About';\nimport { Navbar } from './components/Navbar';\nimport Register from './pages/Register';\nimport Login from './pages/Login';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateState = username => {\n      this.setState({\n        username: username\n      });\n      console.log(this.state);\n    };\n\n    this.handle_login = (e, data) => {\n      e.preventDefault();\n      fetch('http://localhost:8000/api/token-auth/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(res => res.json()).then(json => {\n        console.log(json);\n        localStorage.setItem('access_token', json.access);\n        localStorage.setItem('refresh_token', json.refresh);\n        this.setState({\n          logged_in: true,\n          displayed_form: ''\n        });\n        this.getCurrentUser();\n        this.history.push('/');\n      });\n    };\n\n    this.handle_logout = () => {\n      fetch(\"http://localhost:8000/api/logout/\", {\n        method: 'POST',\n        headers: {\n          Authorization: 'JWT ' + localStorage.getItem('access_token'),\n          'Content-Type': 'application/json',\n          accept: 'application/json'\n        },\n        body: JSON.stringify({\n          refresh_token: localStorage.getItem('refresh_token')\n        })\n      });\n      localStorage.removeItem('access_token');\n      localStorage.removeItem('refresh_token');\n      this.setState({\n        logged_in: false,\n        username: '',\n        user_id: ''\n      });\n      this.history.push('/login');\n    };\n\n    this.state = {\n      displayed_form: '',\n      logged_in: localStorage.getItem('access_token') ? true : false,\n      username: '',\n      user_id: ''\n    };\n    this.history = createBrowserHistory();\n    this.updateState = this.updateState.bind(this);\n  }\n\n  getCurrentUser() {\n    if (this.state.logged_in) {\n      fetch('http://localhost:8000/api/current_user/', {\n        headers: {\n          Authorization: `JWT ${localStorage.getItem('access_token')}`\n        }\n      }).then(res => res.json()).then(json => {\n        this.setState({\n          username: json.username,\n          user_id: json.id\n        });\n        console.log(this.state);\n      });\n    } else {\n      this.history.push('/login');\n    }\n  }\n\n  componentDidMount() {\n    this.getCurrentUser();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Router, {\n      history: this.history,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      logged_in: this.state.logged_in,\n      username: this.state.username,\n      handle_logout: this.handle_logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: '/',\n      exact: true,\n      component: Home,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: '/about',\n      exact: true,\n      component: About,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: '/register',\n      exact: true,\n      component: Register,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: '/login',\n      render: props => /*#__PURE__*/React.createElement(Login, Object.assign({}, props, {\n        handle_login: this.handle_login,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 32\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: '/logout',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    }))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/uladzimir/All/Studies/microblog/microblog/frontend/src/App.js"],"names":["React","Component","useState","BrowserRouter","Redirect","Router","Route","Switch","$","Popper","axiosInstance","createBrowserHistory","Home","About","Navbar","Register","Login","App","constructor","props","updateState","username","setState","console","log","state","handle_login","e","data","preventDefault","fetch","method","headers","body","JSON","stringify","then","res","json","localStorage","setItem","access","refresh","logged_in","displayed_form","getCurrentUser","history","push","handle_logout","Authorization","getItem","accept","refresh_token","removeItem","user_id","bind","id","componentDidMount","render"],"mappings":"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","sourcesContent":["import React, { Component, useState } from 'react';\nimport {BrowserRouter, Redirect, Router, Route, Switch} from 'react-router-dom'\n\t\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport Popper from 'popper.js';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport axiosInstance from 'axios';\nimport { createBrowserHistory } from 'history';\n\nimport {Home} from './pages/Home'\nimport {About} from './pages/About'\nimport {Navbar} from './components/Navbar'\nimport Register from './pages/Register'\nimport Login from './pages/Login'\n\nclass App extends Component{\n  constructor(props) {\n    super(props);\n    this.state = {\n      displayed_form: '',\n      logged_in: localStorage.getItem('access_token') ? true : false,\n      username: '',\n      user_id: ''\n    };\n    this.history = createBrowserHistory();\n    this.updateState = this.updateState.bind(this)\n  }\n\n  updateState = (username) =>{\n    this.setState({\n      username:username\n    })\n    console.log(this.state);\n  }\n\n  getCurrentUser(){\n    if (this.state.logged_in){\n      fetch('http://localhost:8000/api/current_user/', {\n        headers: {\n          Authorization: `JWT ${localStorage.getItem('access_token')}`\n        }\n      })\n      .then(res => res.json())\n      .then(json => {\n        this.setState({\n          username: json.username,\n          user_id: json.id\n        });\n        console.log(this.state)\n      });\n    }\n    else{\n      this.history.push('/login');\n    }\n  }\n\n  componentDidMount() {\n    this.getCurrentUser();\n  }\n\n  handle_login = (e, data) => {\n    e.preventDefault();\n    fetch('http://localhost:8000/api/token-auth/', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    })\n      .then(res => res.json())\n      .then(json => {\n        console.log(json);\n        localStorage.setItem('access_token', json.access);\n        localStorage.setItem('refresh_token', json.refresh);\n        this.setState({\n          logged_in: true,\n          displayed_form: '',\n        });\n        this.getCurrentUser();\n        this.history.push('/')\n      })\n  };\n\n  handle_logout = () => {\n    fetch(\"http://localhost:8000/api/logout/\", {\n        method: 'POST',\n        headers: {\n          Authorization: 'JWT ' + localStorage.getItem('access_token'),\n          'Content-Type':'application/json',\n          accept: 'application/json',\n      },\n        body: JSON.stringify(\n          {\n            refresh_token: localStorage.getItem('refresh_token')\n          }\n          ),\n      }\n    )\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n    this.setState({ logged_in: false, username: '', user_id: ''});\n    this.history.push('/login')\n  };\n\n  render(){\n    return (\n      <Router history={this.history}>\n        <div>\n        <Navbar  \n          logged_in={this.state.logged_in}\n          username={this.state.username}\n          handle_logout={this.handle_logout}\n        />\n        <Switch>\n          <Route path={'/'} exact component={Home}/>\n          <Route path={'/about'} exact component={About}/>\n          <Route path={'/register'} exact component={Register}/>\n          <Route path={'/login'}  \n            render={(props) => <Login {...props} \n              handle_login={this.handle_login} \n            />}/>\n          <Route path={'/logout'} />\n        </Switch>\n        </div>\n    </Router>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}